/*
Navicat MySQL Data Transfer

Source Server         : localhost @ root
Source Server Version : 50717
Source Host           : localhost:3306
Source Database       : suficiencia

Target Server Type    : MYSQL
Target Server Version : 50717
File Encoding         : 65001

Date: 2017-03-24 02:38:32
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for `activities`
-- ----------------------------
DROP TABLE IF EXISTS `activities`;
CREATE TABLE `activities` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `group_id` int(10) unsigned NOT NULL,
  `name` varchar(64) COLLATE utf8_unicode_ci NOT NULL,
  `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `location` varchar(64) COLLATE utf8_unicode_ci NOT NULL,
  `content` blob NOT NULL,
  PRIMARY KEY (`id`),
  KEY `activities_group_id` (`group_id`),
  CONSTRAINT `activities_group_id` FOREIGN KEY (`group_id`) REFERENCES `groups` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Records of activities
-- ----------------------------
INSERT INTO `activities` VALUES ('7', '1', 'Actividad numero 1 para este', '2017-03-24 09:34:22', 'San Jose', 0x416374697669646164206E756D65726F20312070617261206573746520677275706F2064652074726162616A6F20416374697669646164206E756D65726F20312070617261206573746520677275706F2064652074726162616A6F20416374697669646164206E756D65726F20312070617261206573746520677275706F2064652074726162616A6F20416374697669646164206E756D65726F20312070617261206573746520677275706F2064652074726162616A6F20416374697669646164206E756D65726F20312070617261206573746520677275706F2064652074726162616A6F20);
INSERT INTO `activities` VALUES ('8', '1', 'Actividad numero 2 para el grupo', '2017-03-24 09:35:55', 'Cartago', 0x54657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E672054657374696E6720);
INSERT INTO `activities` VALUES ('10', '1', 'Actividad numero 3 para el grupo de prueba', '2017-03-24 09:36:39', 'Puntarenas', 0x416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20416374697669646164206E756D65726F2032207061726120656C20677275706F20);

-- ----------------------------
-- Table structure for `content`
-- ----------------------------
DROP TABLE IF EXISTS `content`;
CREATE TABLE `content` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `key` varchar(32) COLLATE utf8_unicode_ci NOT NULL,
  `content` blob NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Records of content
-- ----------------------------
INSERT INTO `content` VALUES ('1', 'name', 0x4F7267616E697A616369C3B36E2073696E2066696E6573206465204C7563726F202D2050616C7069746F73);
INSERT INTO `content` VALUES ('2', 'organization', 0x4E756573747261206F7267616E697A6163696F6E20636F6E73746120646520656D706C6561646F7320646564696361646F732061206E756573747261206D6973696F6E);
INSERT INTO `content` VALUES ('3', 'mission', 0x4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E0A0A5374616E64696E67206F6E20746865205269766572205468616D65732C204C6F6E646F6E20686173206265656E2061206D616A6F7220736574746C656D656E7420666F722074776F206D696C6C656E6E69612C2069747320686973746F727920676F696E67206261636B20746F2069747320666F756E64696E672062792074686520526F6D616E732C2077686F206E616D6564206974204C6F6E64696E69756D2E);
INSERT INTO `content` VALUES ('4', 'vision', 0x4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E0D0A0D0A5374616E64696E67206F6E20746865205269766572205468616D65732C204C6F6E646F6E20686173206265656E2061206D616A6F7220736574746C656D656E7420666F722074776F206D696C6C656E6E69612C2069747320686973746F727920676F696E67206261636B20746F2069747320666F756E64696E672062792074686520526F6D616E732C2077686F206E616D6564206974204C6F6E64696E69756D2E);
INSERT INTO `content` VALUES ('5', 'values', 0x4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E4C6F6E646F6E20697320746865206361706974616C2063697479206F6620456E676C616E642E20497420697320746865206D6F737420706F70756C6F7573206369747920696E2074686520556E69746564204B696E67646F6D2C20776974682061206D6574726F706F6C6974616E2061726561206F66206F766572203133206D696C6C696F6E20696E6861626974616E74732E0D0A0D0A5374616E64696E67206F6E20746865205269766572205468616D65732C204C6F6E646F6E20686173206265656E2061206D616A6F7220736574746C656D656E7420666F722074776F206D696C6C656E6E69612C2069747320686973746F727920676F696E67206261636B20746F2069747320666F756E64696E672062792074686520526F6D616E732C2077686F206E616D6564206974204C6F6E64696E69756D2E);

-- ----------------------------
-- Table structure for `groups`
-- ----------------------------
DROP TABLE IF EXISTS `groups`;
CREATE TABLE `groups` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(32) COLLATE utf8_unicode_ci NOT NULL,
  `summary` blob NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Records of groups
-- ----------------------------
INSERT INTO `groups` VALUES ('1', 'Grupo Trabajo 1', 0x726573756D656E2064656C20677275706F2031);
INSERT INTO `groups` VALUES ('2', 'Grupo Trabajo 2', 0x726573756D656E2064656C20677275706F2032);
INSERT INTO `groups` VALUES ('3', 'Grupo Trabajo 3', 0x726573756D656E2064656C20677275706F2033);
INSERT INTO `groups` VALUES ('4', 'Grupo Trabajo 4', 0x726573756D656E2064656C20677275706F2034);
INSERT INTO `groups` VALUES ('5', 'Grupo Trabajo 5', 0x726573756D656E2064656C20677275706F2035);
INSERT INTO `groups` VALUES ('6', 'Grupo Trabajo 6', 0x726573756D656E2064656C20677275706F2036);

-- ----------------------------
-- Table structure for `objectives`
-- ----------------------------
DROP TABLE IF EXISTS `objectives`;
CREATE TABLE `objectives` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `group_id` int(10) unsigned NOT NULL,
  `content` blob NOT NULL,
  PRIMARY KEY (`id`),
  KEY `objectives_group_id` (`group_id`),
  CONSTRAINT `objectives_group_id` FOREIGN KEY (`group_id`) REFERENCES `groups` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Records of objectives
-- ----------------------------
INSERT INTO `objectives` VALUES ('1', '1', 0x616C7364666A616C7364666C616C666B616A6C66616A6C73666C3B6173666C6B61666C61666C);
INSERT INTO `objectives` VALUES ('2', '1', 0x616C736466616C6A6661206A646C3B6A616C736A646673646C666A61736C64);
INSERT INTO `objectives` VALUES ('3', '2', 0x61646661666173666161666173);
INSERT INTO `objectives` VALUES ('4', '2', 0x616661736466616661736664617366);
INSERT INTO `objectives` VALUES ('5', '3', 0x61736466617366617364666173666461);
INSERT INTO `objectives` VALUES ('6', '1', 0x6E7565766F206F626A657469766F207061726120656C20677275706F2064652074726162616A6F202331);
INSERT INTO `objectives` VALUES ('7', '6', 0x6E7565766F206F626A657469766F);

-- ----------------------------
-- Table structure for `users`
-- ----------------------------
DROP TABLE IF EXISTS `users`;
CREATE TABLE `users` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `username` varchar(32) COLLATE utf8_unicode_ci NOT NULL,
  `password` varchar(16) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Records of users
-- ----------------------------
INSERT INTO `users` VALUES ('1', 'tavo', '123');

-- ----------------------------
-- Procedure structure for `activitiesById`
-- ----------------------------
DROP PROCEDURE IF EXISTS `activitiesById`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `activitiesById`(IN `groupId` int)
BEGIN

	select * from activities a
	where a.group_id = `groupId` 
	order by a.id desc;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `content`
-- ----------------------------
DROP PROCEDURE IF EXISTS `content`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `content`(IN `key` varchar(32))
BEGIN

	select * from content c where c.`key` = `key` limit 1;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `contentList`
-- ----------------------------
DROP PROCEDURE IF EXISTS `contentList`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `contentList`()
BEGIN

	select * from content c;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `deleteActivity`
-- ----------------------------
DROP PROCEDURE IF EXISTS `deleteActivity`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `deleteActivity`(IN `pId` int)
BEGIN

	delete a from activities a where a.id = `pId`;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `groupById`
-- ----------------------------
DROP PROCEDURE IF EXISTS `groupById`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `groupById`(IN `groupId` int)
BEGIN

	select * from groups g
	where g.id = `groupId`;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `groups`
-- ----------------------------
DROP PROCEDURE IF EXISTS `groups`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `groups`()
BEGIN

	select * from groups g;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `newActivity`
-- ----------------------------
DROP PROCEDURE IF EXISTS `newActivity`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `newActivity`(IN `id` INT,IN `name` VARCHAR(64), IN `date` timestamp, IN `location` VARCHAR(64),IN `content` blob)
BEGIN

	insert into activities values(null,`id`,`name`, `date`, `location`, `content`);
	select * from activities a where a.id = LAST_INSERT_ID();

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `newGroup`
-- ----------------------------
DROP PROCEDURE IF EXISTS `newGroup`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `newGroup`(IN `group` varchar(64),IN `summary` blob)
BEGIN

	insert into groups values(null,`group`,`summary`);
	select * from groups g where g.id = LAST_INSERT_ID();

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `newObjective`
-- ----------------------------
DROP PROCEDURE IF EXISTS `newObjective`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `newObjective`(IN `id` INT,IN `objective` blob)
BEGIN

	insert into objectives values(null,`id`,`objective`);
	select * from objectives o where o.id = LAST_INSERT_ID();

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `objectivesById`
-- ----------------------------
DROP PROCEDURE IF EXISTS `objectivesById`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `objectivesById`(IN `groupId` int)
BEGIN

	select * from objectives o
	where o.group_id = `groupId`;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `updateContent`
-- ----------------------------
DROP PROCEDURE IF EXISTS `updateContent`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `updateContent`(IN `id` int,IN `content` blob)
BEGIN

	update content c set c.content = `content` where c.id = `id`;

	select * from content c where c.id = `id`;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `updateGroup`
-- ----------------------------
DROP PROCEDURE IF EXISTS `updateGroup`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `updateGroup`(IN `id` INT, IN `group` varchar(64),IN `summary` blob)
BEGIN

	update groups u set u.`name` = `group`,u.summary = `summary` where u.id = `id`;

	select * from groups g where g.id = `id`;

END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for `user`
-- ----------------------------
DROP PROCEDURE IF EXISTS `user`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `user`(IN `user` varchar(32))
BEGIN

	select * from users u where u.username = `user`;

END
;;
DELIMITER ;
